<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Open SMB Share (ms-search & file fallback)</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; padding: 2rem; }
    button { padding: .6rem 1rem; margin: .5rem 0; }
    .note { color: #555; font-size: .9rem; margin-top: 1rem; }
  </style>
</head>
<body>
  <h1>Open SMB Share</h1>
  <p>Target UNC path: <code>\\192.168.50.193\public</code></p>

  <button id="open-ms-search">Open using <code>search-ms:</code> (Windows)</button>
  <button id="open-file">Open using <code>file:</code> URI (fallback)</button>

  <div class="note">
    <strong>Reminder:</strong> This depends on OS/browser support for these URIs. If nothing happens, try opening this file locally (double-click the HTML) or run the code from a trusted environment.
  </div>

  <script>
    // The UNC path we want to open
    const uncPath = "\\\\192.168.50.193\\public"; // note: backslashes

    // Build a search-ms: URI similar to how Windows Explorer search URIs look.
    // We URL-encode the location parameter (backslashes become %5C).
    function buildSearchMsUri(unc) {
      // crumb=location:<encoded UNC>
      const encodedLocation = encodeURIComponent(unc);
      // Add a displayname so Explorer shows something
      const displayName = encodeURIComponent("Open SMB Share");
      // Basic search-ms format: search-ms:displayname=...&crumb=location:<encoded>
      return `search-ms:displayname=${displayName}&crumb=location:${encodedLocation}&query=.`;
    }

    // Build a file: URI for a UNC path.
    // Many clients expect file:////host/share  (4 slashes: scheme + two leading slashes of UNC --> results in 4)
    function buildFileUriFromUnc(unc) {
      // remove leading backslashes if present, then prefix with file:////
      const trimmed = unc.replace(/^\\\\+/, ""); // "192.168.50.193\public"
      // Replace backslashes with forward slashes for URL
      const slashPath = trimmed.replace(/\\/g, "/");
      return `file:////${slashPath}`; // e.g. file:////192.168.50.193/public
    }

    document.getElementById("open-ms-search").addEventListener("click", () => {
      const uri = buildSearchMsUri(uncPath);
      console.log(uri);
      // Attempt navigation via assignment (some browsers will prompt or block)
      // Also create a temporary anchor and click it as an alternate approach.
      try {
        // First try direct navigation
        window.location.href = uri;
      } catch (e) {
        // If direct assignment fails, try creating and clicking an anchor
        const a = document.createElement("a");
        a.href = uri;
        a.rel = "noopener";
        a.style.display = "none";
        document.body.appendChild(a);
        a.click();
        a.remove();
      }
    });

    document.getElementById("open-file").addEventListener("click", () => {
      const uri = buildFileUriFromUnc(uncPath);
      // Try opening the file URI (often blocked by browsers from http(s) pages)
      try {
        window.location.href = uri;
      } catch (e) {
        const a = document.createElement("a");
        a.href = uri;
        a.style.display = "none";
        document.body.appendChild(a);
        a.click();
        a.remove();
      }
    });
  </script>
</body>
</html>
